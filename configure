#!/bin/sh
echo "Making top-level makefile... note this will fail if there are spaces in your directories!"
DIRS="$(find . -mindepth 2 -maxdepth 2 -iname 'makefile' -exec dirname "{}" \;)"

echo -e ".PHONY: all" $DIRS "\n\n" > makefile

echo -e "all:" $DIRS "\n\n" >> makefile
for dir in $DIRS; do
    echo -e "$dir:\n\tmake -C $dir\n\n" >> makefile
done

